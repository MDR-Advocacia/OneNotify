2025-09-25 08:49:48,558 [INFO] - ============================================================
2025-09-25 08:49:48,558 [INFO] - INICIANDO NOVA EXECUÇÃO DA RPA
2025-09-25 08:49:48,558 [INFO] - ============================================================
2025-09-25 08:49:48,561 [INFO] - 36 notificações com erro ou travadas foram resetadas para 'Pendente'.
2025-09-25 08:49:48,783 [INFO] - 
FASE 1: LOGIN E CONFIGURAÇÃO DA SESSÃO
2025-09-25 08:50:02,933 [INFO] - 
FASE 2: EXTRAÇÃO DE NOVAS NOTIFICAÇÕES E REGISTRO DE CIÊNCIA
2025-09-25 08:50:02,935 [INFO] - Iniciando módulo de extração e ciência...
2025-09-25 08:50:02,936 [INFO] - Navegando para a Central de Notificações...
2025-09-25 08:50:04,246 [INFO] - Acessando a 'Visão do Advogado'...
2025-09-25 08:50:05,393 [INFO] - --- Processando tarefa: Andamento de publicação em processo de condução terceirizada ---
2025-09-25 08:50:05,424 [INFO] - 30 itens encontrados. Abrindo detalhes...
2025-09-25 08:50:06,263 [INFO] -     - Verificando página 1...
2025-09-25 08:50:09,024 [INFO] -     - Navegando para a próxima página...
2025-09-25 08:50:09,306 [INFO] -     - Verificando página 2...
2025-09-25 08:50:09,386 [INFO] -     - Navegando para a próxima página...
2025-09-25 08:50:09,524 [INFO] -     - Verificando página 3...
2025-09-25 08:50:12,474 [INFO] -     - Confirmando a ciência...
2025-09-25 08:50:44,476 [ERROR] - Falha ao processar a tarefa 'Andamento de publicação em processo de condução terceirizada': Page.wait_for_selector: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("table[id*=\"dataTableVisaoAdvogado\"]") to be visible
    - waiting for navigation to finish...
    - navigated to "https://juridico.bb.com.br/paj/paginas/negocio/centralnotificacoes/resumoNotificacoesPendencias.seam?cid=2127270"
Traceback (most recent call last):
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/modulo_notificacoes.py", line 82, in extrair_dados_e_dar_ciencia_em_lote
    page.wait_for_selector('table[id*="dataTableVisaoAdvogado"]', state='visible', timeout=30000)
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/sync_api/_generated.py", line 8182, in wait_for_selector
    self._sync(
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_sync_base.py", line 115, in _sync
    return task.result()
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_page.py", line 423, in wait_for_selector
    return await self._main_frame.wait_for_selector(**locals_to_params(locals()))
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_frame.py", line 369, in wait_for_selector
    await self._channel.send(
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_connection.py", line 558, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TimeoutError: Page.wait_for_selector: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("table[id*=\"dataTableVisaoAdvogado\"]") to be visible
    - waiting for navigation to finish...
    - navigated to "https://juridico.bb.com.br/paj/paginas/negocio/centralnotificacoes/resumoNotificacoesPendencias.seam?cid=2127270"

2025-09-25 08:50:45,869 [INFO] - Tarefa 'Andamento de publicação em processo de condução terceirizada' concluída. 17 novas notificações salvas. 20 ciências registradas.
2025-09-25 08:50:45,869 [INFO] - --- Processando tarefa: Doc. anexado por empresa externa em processo terceirizado ---
2025-09-25 08:50:45,894 [WARNING] - Tarefa 'Doc. anexado por empresa externa em processo terceirizado' não encontrada. Pulando.
2025-09-25 08:50:45,894 [INFO] - --- Processando tarefa: Inclusão de Documentos no NPJ ---
2025-09-25 08:50:45,897 [WARNING] - Tarefa 'Inclusão de Documentos no NPJ' não encontrada. Pulando.
2025-09-25 08:50:45,897 [INFO] - Extração/ciência concluídas. Salvas: 17, Ciências: 20.
2025-09-25 08:50:45,897 [INFO] - 
FASE 3: PROCESSAMENTO DETALHADO EM LOTES
2025-09-25 08:50:45,898 [INFO] - Total de 53 NPJs pendentes para detalhamento.
2025-09-25 08:50:45,900 [INFO] - Iniciando processamento detalhado de um lote de 50 NPJs.
2025-09-25 08:50:45,970 [INFO] - 
[1/50] Processando NPJ: 2009/0079019-000
2025-09-25 08:50:46,140 [ERROR] -   Falha ao processar NPJ 2009/0079019-000: Page.goto: net::ERR_HTTP_RESPONSE_CODE_FAILURE at https://juridico.bb.com.br/paj/processo/resumo/resumo.mti?numeroNpj=2009/0079019-000
Call log:
  - navigating to "https://juridico.bb.com.br/paj/processo/resumo/resumo.mti?numeroNpj=2009/0079019-000", waiting until "load"
Traceback (most recent call last):
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/processamento_detalhado.py", line 90, in processar_detalhes_de_lote
    page.goto(f"{url_base}{npj}")
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/sync_api/_generated.py", line 9019, in goto
    self._sync(
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_sync_base.py", line 115, in _sync
    return task.result()
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_page.py", line 556, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_frame.py", line 153, in goto
    await self._channel.send(
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_connection.py", line 558, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: Page.goto: net::ERR_HTTP_RESPONSE_CODE_FAILURE at https://juridico.bb.com.br/paj/processo/resumo/resumo.mti?numeroNpj=2009/0079019-000
Call log:
  - navigating to "https://juridico.bb.com.br/paj/processo/resumo/resumo.mti?numeroNpj=2009/0079019-000", waiting until "load"

2025-09-25 08:50:46,141 [CRITICAL] - Erro crítico durante o processamento do lote: name 'database' is not defined
Traceback (most recent call last):
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/processamento_detalhado.py", line 90, in processar_detalhes_de_lote
    page.goto(f"{url_base}{npj}")
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/sync_api/_generated.py", line 9019, in goto
    self._sync(
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_sync_base.py", line 115, in _sync
    return task.result()
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_page.py", line 556, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_frame.py", line 153, in goto
    await self._channel.send(
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/venv/lib/python3.9/site-packages/playwright/_impl/_connection.py", line 558, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: Page.goto: net::ERR_HTTP_RESPONSE_CODE_FAILURE at https://juridico.bb.com.br/paj/processo/resumo/resumo.mti?numeroNpj=2009/0079019-000
Call log:
  - navigating to "https://juridico.bb.com.br/paj/processo/resumo/resumo.mti?numeroNpj=2009/0079019-000", waiting until "load"


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/rildonpimentelpereira/GitHub/OneNotify/processamento_detalhado.py", line 120, in processar_detalhes_de_lote
    database.marcar_npj_como_erro(npj)
NameError: name 'database' is not defined
2025-09-25 08:50:46,149 [INFO] - Processamento do lote concluído.
2025-09-25 08:50:46,149 [INFO] - Finalizando a automação e fechando o navegador.
2025-09-25 08:50:46,162 [INFO] - 
--- RESUMO DA EXECUÇÃO ---
2025-09-25 08:50:46,162 [INFO] - Timestamp: 2025-09-25 08:50:46
2025-09-25 08:50:46,162 [INFO] - Duracao Total: 57.6
2025-09-25 08:50:46,162 [INFO] - Tempo Medio Npj: 0
2025-09-25 08:50:46,162 [INFO] - Notificacoes Salvas: 17
2025-09-25 08:50:46,162 [INFO] - Ciencias Registradas: 20
2025-09-25 08:50:46,162 [INFO] - Andamentos: 0
2025-09-25 08:50:46,162 [INFO] - Documentos: 0
2025-09-25 08:50:46,162 [INFO] - Sucesso: 0
2025-09-25 08:50:46,162 [INFO] - Falha: 0
2025-09-25 08:50:46,162 [INFO] - ============================================================
2025-09-25 08:50:46,162 [INFO] - Execução finalizada. Log completo em: logs/log_2025-09-25_08-49-48.txt
